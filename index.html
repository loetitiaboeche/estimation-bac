<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Estimation Bac 2026 - Calculateur Officiel Baccalaur√©at G√©n√©ral</title>
    <meta name="description" content="Calculez votre estimation au baccalaur√©at g√©n√©ral 2025-2026. Importez votre bulletin PDF, simulez vos notes et d√©couvrez quelles notes obtenir pour votre mention. Donn√©es officielles du Minist√®re.">
    <meta name="keywords" content="bac 2026, calculateur bac, estimation bac, simulateur bac, mention bac, notes bac, objectif bac, baccalaur√©at g√©n√©ral">
    <meta name="author" content="NSica">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://estimation-bac.fr">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://estimation-bac.fr">
    <meta property="og:title" content="Estimation Bac 2026 - Calculateur Officiel">
    <meta property="og:description" content="Importez votre bulletin, simulez vos notes et d√©couvrez quelles notes obtenir pour votre mention !">
    <meta property="og:locale" content="fr_FR">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://estimation-bac.fr">
    <meta property="twitter:title" content="Estimation Bac 2026 - Calculateur Officiel">
    <meta property="twitter:description" content="Simulateur intelligent pour le baccalaur√©at g√©n√©ral 2025-2026">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Estimation Bac",
      "description": "Calculateur d'estimation pour le baccalaur√©at g√©n√©ral avec simulateur et mode objectifs",
      "url": "https://estimation-bac.fr",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "EUR"
      },
      "publisher": {
        "@type": "Organization",
        "name": "NSica",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "179 avenue de Muret",
          "addressLocality": "Toulouse",
          "postalCode": "31300",
          "addressCountry": "FR"
        },
        "telephone": "+33562200804"
      }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 150px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .subtitle {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .badge-officiel {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .hero-banner {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 40px 30px;
            text-align: center;
            border-bottom: 4px solid #667eea;
        }

        .hero-banner h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .hero-banner p {
            color: #555;
            font-size: 1.1em;
            line-height: 1.8;
            max-width: 800px;
            margin: 0 auto 20px;
        }

        .hero-features {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 25px;
        }

        .hero-feature {
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hero-feature span {
            font-size: 1.5em;
        }

        .cta-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .cta-button:hover {
            transform: translateY(-3px);
        }

        .main-content {
            padding: 30px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .info-box.success {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .info-box.warning {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: #f8f9ff;
        }

        .verification-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        .verification-table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
        }

        .verification-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .verification-table input[type="number"] {
            width: 80px;
            padding: 5px;
            border: 2px solid #ddd;
            border-radius: 5px;
        }

        .verification-table input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 10px 5px;
        }

        .button:hover {
            transform: translateY(-2px);
        }

        .button.secondary {
            background: #6c757d;
        }

        .button.success {
            background: #28a745;
        }

        .results {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .result-item {
            background: rgba(255,255,255,0.2);
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .mode-switch {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }

        .mode-btn {
            flex: 1;
            max-width: 300px;
            padding: 15px 20px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            color: white;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: white;
            color: #667eea;
        }

        .simulator, .objectives {
            background: white;
            color: #333;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .simulator h3, .objectives h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .slider-container {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 8px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .objective-selector {
            margin: 25px 0;
        }

        .objective-option {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9ff;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .objective-option:hover {
            border-color: #667eea;
        }

        .objective-option.selected {
            background: #e3f2fd;
            border-color: #2196F3;
        }

        .objective-option input[type="radio"] {
            margin-right: 10px;
        }

        .notes-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .notes-table th, .notes-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .notes-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .notes-table td.note-high {
            background: #ffebee;
            font-weight: 700;
        }

        .mention-badge {
            background: white;
            color: #667eea;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            display: inline-block;
            margin-top: 10px;
        }

        .mention-badge.tb {
            background: #FFD700;
            color: #333;
        }

        .mention-badge.b {
            background: #C0C0C0;
            color: #333;
        }

        .mention-badge.ab {
            background: #CD7F32;
            color: white;
        }

        .coef-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .coef-table th, .coef-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .coef-table th {
            background: #f0f0f0;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .specialites-choice {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .spe-option {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 10px 0;
            background: #f8f9ff;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .spe-option:hover {
            border-color: #667eea;
        }

        .spe-option input[type="checkbox"] {
            margin-right: 15px;
        }

        .spe-option.selected {
            background: #e3f2fd;
            border-color: #2196F3;
        }

        footer {
            background: #2c3e50;
            color: white;
            padding: 30px 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h3 {
            color: #3498db;
            margin-bottom: 15px;
        }

        .footer-section p, .footer-section a {
            color: #ecf0f1;
            line-height: 1.8;
            font-size: 0.9em;
        }

        .footer-section a {
            text-decoration: none;
        }

        .footer-section a:hover {
            color: #3498db;
        }

        .footer-bottom {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #34495e;
            font-size: 0.85em;
            color: #95a5a6;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(255,255,255,0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .hidden {
            display: none;
        }

        #fileInput {
            display: none;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5em;
            }

            .hero-banner h2 {
                font-size: 1.4em;
            }

            .hero-features {
                flex-direction: column;
            }

            .tabs {
                flex-direction: column;
            }

            .footer-content {
                grid-template-columns: 1fr;
            }

            .mode-switch {
                flex-direction: column;
            }

            .mode-btn {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Estimation Bac</h1>
            <p class="subtitle">Calculateur de r√©sultats au baccalaur√©at g√©n√©ral 2025-2026</p>
            <div class="badge-officiel">‚úì Bas√© sur les donn√©es officielles du Minist√®re de l'√âducation Nationale</div>
        </header>

        <!-- Hero Banner -->
        <div class="hero-banner">
            <h2>üéØ Estimez vos r√©sultats au Bac en 3 clics !</h2>
            <p>
                <strong>Importez votre bulletin</strong>, v√©rifiez vos notes et d√©couvrez votre estimation instantan√©e. 
                Puis testez diff√©rents <strong>objectifs</strong> avec notre simulateur intelligent pour savoir 
                <strong>exactement quelles notes obtenir</strong> pour d√©crocher la mention de vos r√™ves !
            </p>
            
            <div class="hero-features">
                <div class="hero-feature">
                    <span>üì§</span>
                    <div><strong>Import PDF</strong><br>Automatique</div>
                </div>
                <div class="hero-feature">
                    <span>‚úì</span>
                    <div><strong>Calculs officiels</strong><br>Minist√®re</div>
                </div>
                <div class="hero-feature">
                    <span>üéÆ</span>
                    <div><strong>Simulateur</strong><br>Interactif</div>
                </div>
                <div class="hero-feature">
                    <span>üéØ</span>
                    <div><strong>Mode Objectifs</strong><br>Notes n√©cessaires</div>
                </div>
            </div>

            <button class="cta-button" onclick="document.getElementById('upload').scrollIntoView({behavior: 'smooth'})">
                üì§ Commencer maintenant
            </button>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="showTab('upload')">üì§ Import Bulletin</button>
                <button class="tab" onclick="showTab('info')">üìñ Comment √ßa marche ?</button>
                <button class="tab" onclick="showTab('coefficients')">üìä Coefficients</button>
            </div>

            <!-- Onglet Upload -->
            <div id="upload" class="tab-content active">
                <div class="section">
                    <h2>üì§ T√©l√©versez votre bulletin de notes</h2>
                    
                    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                        <div style="font-size: 3em; margin-bottom: 15px;">üìÑ</div>
                        <div style="font-size: 1.1em; margin-bottom: 10px;">Cliquez pour s√©lectionner un bulletin PDF</div>
                        <div style="font-size: 0.9em; color: #999;">Bulletin de 1√®re ou Terminale</div>
                    </div>
                    
                    <input type="file" id="fileInput" accept=".pdf" multiple>
                    
                    <div id="extractionStatus"></div>
                </div>

                <!-- Zone choix sp√©cialit√©s -->
                <div id="specialitesZone" class="section hidden">
                    <h2>üéØ Choix de vos sp√©cialit√©s</h2>
                    
                    <div class="info-box">
                        <p><strong>üìö Important :</strong> S√©lectionnez les <strong>2 sp√©cialit√©s que vous gardez en Terminale</strong></p>
                    </div>

                    <div class="specialites-choice" id="specialitesContent"></div>

                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button success" onclick="validerSpecialites()">‚úÖ Valider mes choix</button>
                    </div>
                </div>

                <!-- Zone de v√©rification -->
                <div id="verificationZone" class="section hidden">
                    <h2>‚úÖ V√©rification des notes extraites</h2>
                    
                    <div class="info-box warning">
                        <p><strong>‚ö†Ô∏è Important : V√©rifiez et corrigez si n√©cessaire</strong></p>
                    </div>

                    <div id="classeTrimestre" style="margin: 20px 0;">
                        <p><strong>Classe :</strong> <span id="classeDetectee">-</span></p>
                        <p><strong>Trimestre :</strong> <span id="trimestreDetecte">-</span></p>
                    </div>

                    <table class="verification-table">
                        <thead>
                            <tr>
                                <th>Mati√®re</th>
                                <th>Note</th>
                                <th>Corriger</th>
                                <th>Coef</th>
                            </tr>
                        </thead>
                        <tbody id="verificationBody"></tbody>
                    </table>

                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button success" onclick="validerVerification()">‚úÖ Valider et Calculer</button>
                        <button class="button secondary" onclick="annulerVerification()">‚ùå Annuler</button>
                    </div>
                </div>

                <!-- Zone r√©sultats -->
                <div id="resultsZone"></div>
            </div>

            <!-- Onglet Info -->
            <div id="info" class="tab-content">
                <div class="section">
                    <h2>üìñ Comment fonctionne le baccalaur√©at g√©n√©ral ?</h2>
                    
                    <h3 style="color: #667eea; margin-top: 20px;">R√©partition de la note finale</h3>
                    <ul style="line-height: 2; margin: 15px 0 15px 30px;">
                        <li><strong>40% de contr√¥le continu</strong> : Vos moyennes de 1√®re et Terminale</li>
                        <li><strong>60% d'√©preuves terminales</strong> : Fran√ßais, Philo, Sp√©cialit√©s, Grand oral</li>
                    </ul>

                    <h3 style="color: #667eea; margin-top: 20px;">Les mentions</h3>
                    <table class="coef-table">
                        <tr><th>Mention</th><th>Moyenne requise</th></tr>
                        <tr><td>Sans mention</td><td>10 ‚â§ moyenne &lt; 12</td></tr>
                        <tr><td>Assez Bien (AB)</td><td>12 ‚â§ moyenne &lt; 14</td></tr>
                        <tr><td>Bien (B)</td><td>14 ‚â§ moyenne &lt; 16</td></tr>
                        <tr><td>Tr√®s Bien (TB)</td><td>16 ‚â§ moyenne &lt; 18</td></tr>
                        <tr><td>F√©licitations</td><td>‚â• 18</td></tr>
                    </table>
                </div>
            </div>

            <!-- Onglet Coefficients -->
            <div id="coefficients" class="tab-content">
                <div class="section">
                    <h2>üìä Tableau des coefficients</h2>
                    
                    <h3 style="color: #667eea; margin-top: 20px;">Contr√¥le Continu (40)</h3>
                    <table class="coef-table">
                        <thead><tr><th>Mati√®re</th><th>1√®re</th><th>Term</th><th>Total</th></tr></thead>
                        <tbody>
                            <tr><td>Sp√© abandonn√©e</td><td>8</td><td>-</td><td>8</td></tr>
                            <tr><td>LVA</td><td>3</td><td>3</td><td>6</td></tr>
                            <tr><td>LVB</td><td>3</td><td>3</td><td>6</td></tr>
                            <tr><td>Histoire-G√©o</td><td>3</td><td>3</td><td>6</td></tr>
                            <tr><td>Ens. Scientifique</td><td>3</td><td>3</td><td>6</td></tr>
                            <tr><td>EPS</td><td>-</td><td>6</td><td>6</td></tr>
                            <tr><td>EMC</td><td>1</td><td>1</td><td>2</td></tr>
                        </tbody>
                    </table>

                    <h3 style="color: #667eea; margin-top: 20px;">√âpreuves Terminales (60)</h3>
                    <table class="coef-table">
                        <thead><tr><th>√âpreuve</th><th>Coef</th></tr></thead>
                        <tbody>
                            <tr><td>Fran√ßais √©crit</td><td>5</td></tr>
                            <tr><td>Fran√ßais oral</td><td>5</td></tr>
                            <tr><td>Philosophie</td><td>8</td></tr>
                            <tr><td>Sp√©cialit√© 1</td><td>16</td></tr>
                            <tr><td>Sp√©cialit√© 2</td><td>16</td></tr>
                            <tr><td>Grand oral</td><td>10</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>üìö √Ä propos</h3>
                <p>Estimation Bac est d√©velopp√© par NSica pour aider les √©l√®ves √† estimer leurs r√©sultats au baccalaur√©at.</p>
            </div>
            
            <div class="footer-section">
                <h3>üìû Contact</h3>
                <p><strong>NSica</strong></p>
                <p>179 avenue de Muret, 31300 Toulouse</p>
                <p>T√©l : 05 62 20 08 04</p>
                <p>Start-up sp√©cialis√©e en solutions logicielles et ERP</p>
            </div>
            
            <div class="footer-section">
                <h3>üîó Ressources</h3>
                <p><a href="https://www.education.gouv.fr" target="_blank" rel="noopener">Minist√®re √âducation</a></p>
            </div>
            
            <div class="footer-section">
                <h3>‚öñÔ∏è L√©gal</h3>
                <p>Aucune donn√©e personnelle collect√©e. Traitement 100% local.</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>¬© 2026 NSica - Tous droits r√©serv√©s | Version 2.3</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        let extractedData = {};
        let verifiedGrades = {};
        let specialitesDetectees = [];
        let specialitesChoisies = [];
        let simulatorValues = {};
        let currentMode = 'simulator';

        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        document.getElementById('fileInput').addEventListener('change', async (e) => {
            const files = e.target.files;
            if (!files.length) return;

            document.getElementById('extractionStatus').innerHTML = `
                <div class="info-box"><p>üìÑ Analyse en cours...</p></div>
            `;

            try {
                for (let file of files) {
                    await extractPDF(file);
                }
                detectSpecialites();
            } catch (error) {
                document.getElementById('extractionStatus').innerHTML = `
                    <div class="info-box warning"><p><strong>‚ö†Ô∏è Erreur</strong></p></div>
                `;
            }
        });

        async function extractPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            
            let fullText = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                fullText += textContent.items.map(item => item.str).join(' ') + '\n';
            }

            analyzeText(fullText);
        }

        function analyzeText(text) {
            const classe = text.match(/terminale|premi√®re/i) ? 
                (text.match(/terminale/i) ? 'Terminale' : 'Premi√®re') : 'Non d√©tect√©';

            let trimestre = 'Non d√©tect√©';
            if (text.match(/1er trimestre/i)) trimestre = '1er Trimestre';
            else if (text.match(/2.*trimestre/i)) trimestre = '2√®me Trimestre';
            else if (text.match(/3.*trimestre/i)) trimestre = '3√®me Trimestre';

            const matieres = [
                { nom: 'Math√©matiques', type: 'specialite', pattern: /math√©matiques.*?(\d+[,.]?\d*)/i },
                { nom: 'Physique-Chimie', type: 'specialite', pattern: /physique.*?(\d+[,.]?\d*)/i },
                { nom: 'SVT', type: 'specialite', pattern: /svt.*?(\d+[,.]?\d*)/i },
                { nom: 'Histoire-G√©o', type: 'normal', coef: 3, pattern: /histoire.*?(\d+[,.]?\d*)/i },
                { nom: 'Anglais', type: 'normal', coef: 3, pattern: /anglais.*?(\d+[,.]?\d*)/i },
                { nom: 'EPS', type: 'normal', coef: 6, pattern: /eps.*?(\d+[,.]?\d*)/i }
            ];

            if (!extractedData.classe) {
                extractedData = { classe, trimestre, matieres: [], specialites: [] };
            }

            matieres.forEach(matiere => {
                const match = text.match(matiere.pattern);
                const note = match ? parseFloat(match[1].replace(',', '.')) : null;
                
                if (note && note >= 0 && note <= 20) {
                    if (matiere.type === 'specialite') {
                        if (!extractedData.specialites.find(s => s.nom === matiere.nom)) {
                            extractedData.specialites.push({ nom: matiere.nom, note });
                        }
                    } else {
                        if (!extractedData.matieres.find(m => m.nom === matiere.nom)) {
                            extractedData.matieres.push({ nom: matiere.nom, note, coef: matiere.coef });
                        }
                    }
                }
            });
        }

        function detectSpecialites() {
            if (extractedData.specialites.length >= 2) {
                specialitesDetectees = extractedData.specialites;
                displaySpecialitesChoice();
            } else {
                displayVerification();
            }
        }

        function displaySpecialitesChoice() {
            let html = `<p><strong>Sp√©cialit√©s d√©tect√©es (${specialitesDetectees.length}) :</strong></p>`;

            specialitesDetectees.forEach((spe, index) => {
                html += `
                    <div class="spe-option" id="spe_${index}">
                        <input type="checkbox" id="check_${index}" onchange="toggleSpecialite(${index}, '${spe.nom}', ${spe.note})">
                        <div><strong>${spe.nom}</strong> (${spe.note.toFixed(2)}/20)</div>
                    </div>
                `;
            });

            document.getElementById('specialitesContent').innerHTML = html;
            document.getElementById('specialitesZone').classList.remove('hidden');
            document.getElementById('extractionStatus').innerHTML = `
                <div class="info-box success"><p>‚úÖ Extraction termin√©e !</p></div>
            `;
        }

        function toggleSpecialite(index, nom, note) {
            const checkbox = document.getElementById(`check_${index}`);
            const div = document.getElementById(`spe_${index}`);
            
            if (checkbox.checked) {
                if (specialitesChoisies.length < 2) {
                    specialitesChoisies.push({ nom, note });
                    div.classList.add('selected');
                } else {
                    checkbox.checked = false;
                    alert('S√©lectionnez exactement 2 sp√©cialit√©s !');
                }
            } else {
                specialitesChoisies = specialitesChoisies.filter(s => s.nom !== nom);
                div.classList.remove('selected');
            }
        }

        function validerSpecialites() {
            if (specialitesChoisies.length !== 2) {
                alert('S√©lectionnez 2 sp√©cialit√©s !');
                return;
            }

            const abandonnee = specialitesDetectees.find(s => 
                !specialitesChoisies.find(c => c.nom === s.nom)
            );

            if (abandonnee) {
                extractedData.matieres.push({
                    nom: `${abandonnee.nom} (abandonn√©e)`,
                    note: abandonnee.note,
                    coef: 8
                });
            }

            document.getElementById('specialitesZone').classList.add('hidden');
            displayVerification();
        }

        function displayVerification() {
            document.getElementById('classeDetectee').textContent = extractedData.classe;
            document.getElementById('trimestreDetecte').textContent = extractedData.trimestre;

            let tableHTML = '';
            extractedData.matieres.forEach((matiere, index) => {
                tableHTML += `
                    <tr>
                        <td>${matiere.nom}</td>
                        <td>${matiere.note.toFixed(2)}</td>
                        <td><input type="number" id="note_${index}" value="${matiere.note}" min="0" max="20" step="0.01"></td>
                        <td>√ó${matiere.coef}</td>
                    </tr>
                `;
            });

            document.getElementById('verificationBody').innerHTML = tableHTML;
            document.getElementById('verificationZone').classList.remove('hidden');
        }

        function validerVerification() {
            verifiedGrades = {
                classe: extractedData.classe,
                trimestre: extractedData.trimestre,
                matieres: []
            };

            extractedData.matieres.forEach((matiere, index) => {
                const noteInput = document.getElementById(`note_${index}`);
                verifiedGrades.matieres.push({
                    nom: matiere.nom,
                    note: parseFloat(noteInput.value),
                    coef: matiere.coef
                });
            });

            calculerAvecSimulateur();
        }

        function annulerVerification() {
            document.getElementById('verificationZone').classList.add('hidden');
            document.getElementById('specialitesZone').classList.add('hidden');
            document.getElementById('extractionStatus').innerHTML = '';
            extractedData = {};
            specialitesChoisies = [];
        }

        function calculerAvecSimulateur() {
            let totalCC = 0;
            let coefCC = 0;

            verifiedGrades.matieres.forEach(m => {
                totalCC += m.note * m.coef;
                coefCC += m.coef;
            });

            const moyenneCC = totalCC / coefCC;

            simulatorValues = {
                francaisEcrit: moyenneCC,
                francaisOral: moyenneCC,
                philosophie: moyenneCC,
                specialite1: specialitesChoisies[0]?.note || moyenneCC,
                specialite2: specialitesChoisies[1]?.note || moyenneCC,
                grandOral: moyenneCC
            };

            displayResultsWithModes(totalCC, coefCC, moyenneCC);
        }

        function displayResultsWithModes(totalCC, coefCC, moyenneCC) {
            const result = calculateFinalGrade(totalCC, coefCC);

            let html = `
                <div class="results">
                    <h2>üìä Votre Estimation</h2>
                    
                    <div class="result-item">
                        <span>Moyenne estim√©e</span><br>
                        <span style="font-size:1.5em;font-weight:700;" id="moyenneDisplay">${result.moyenne.toFixed(2)}/20</span>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" style="width:${result.percentage}%" id="progressBar">
                            ${result.percentage.toFixed(1)}%
                        </div>
                    </div>
                    
                    <div class="result-item">
                        <span id="statusDisplay">${result.status}</span>
                    </div>

                    ${result.mention !== 'Sans mention' && result.mention !== 'Refus√©' ? `
                        <div style="text-align:center;margin-top:20px;">
                            <div class="mention-badge ${result.mentionClass}" id="mentionBadge">${result.mention}</div>
                        </div>
                    ` : ''}

                    <div class="mode-switch">
                        <button class="mode-btn active" id="simBtn" onclick="switchMode('simulator', ${totalCC}, ${coefCC})">
                            üéÆ Simulateur
                        </button>
                        <button class="mode-btn" id="objBtn" onclick="switchMode('objectives', ${totalCC}, ${coefCC})">
                            üéØ Mode Objectifs
                        </button>
                    </div>

                    <div id="modeContent"></div>
                </div>
            `;

            document.getElementById('resultsZone').innerHTML = html;
            document.getElementById('verificationZone').classList.add('hidden');
            
            switchMode('simulator', totalCC, coefCC);
        }

        function switchMode(mode, totalCC, coefCC) {
            currentMode = mode;
            document.getElementById('simBtn').classList.toggle('active', mode === 'simulator');
            document.getElementById('objBtn').classList.toggle('active', mode === 'objectives');

            if (mode === 'simulator') {
                displaySimulator(totalCC, coefCC);
            } else {
                displayObjectives(totalCC, coefCC);
            }
        }

        function displaySimulator(totalCC, coefCC) {
            let html = `
                <div class="simulator">
                    <h3>üéÆ Simulateur Interactif</h3>
                    <p style="color:#666;margin-bottom:20px;">Modifiez les notes pour voir l'impact :</p>
            `;

            const epreuves = [
                { key: 'francaisEcrit', label: 'üìù Fran√ßais √©crit', coef: 5 },
                { key: 'francaisOral', label: 'üì¢ Fran√ßais oral', coef: 5 },
                { key: 'philosophie', label: 'üí≠ Philosophie', coef: 8 },
                { key: 'specialite1', label: `üî¨ ${specialitesChoisies[0]?.nom || 'Sp√© 1'}`, coef: 16 },
                { key: 'specialite2', label: `üß¨ ${specialitesChoisies[1]?.nom || 'Sp√© 2'}`, coef: 16 },
                { key: 'grandOral', label: 'üé§ Grand oral', coef: 10 }
            ];

            epreuves.forEach(epr => {
                html += `
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>${epr.label} <span style="color:#666;">(coef ${epr.coef})</span></span>
                            <span style="font-weight:700;color:#667eea;" id="val_${epr.key}">${simulatorValues[epr.key].toFixed(1)}</span>
                        </div>
                        <input type="range" min="0" max="20" step="0.5" value="${simulatorValues[epr.key]}" 
                               onchange="updateSimulator('${epr.key}', this.value, ${totalCC}, ${coefCC})">
                    </div>
                `;
            });

            html += `</div>`;
            document.getElementById('modeContent').innerHTML = html;
        }

        function displayObjectives(totalCC, coefCC) {
            let html = `
                <div class="objectives">
                    <h3>üéØ Mode Objectifs</h3>
                    <p style="color:#666;margin-bottom:20px;">Choisissez votre objectif :</p>
                    
                    <div class="objective-selector">
                        <div class="objective-option" onclick="selectObjective(10, ${totalCC}, ${coefCC})">
                            <input type="radio" name="obj" value="10"> <strong>Admission</strong> (10/20)
                        </div>
                        <div class="objective-option" onclick="selectObjective(12, ${totalCC}, ${coefCC})">
                            <input type="radio" name="obj" value="12"> <strong>Assez Bien</strong> (12/20)
                        </div>
                        <div class="objective-option" onclick="selectObjective(14, ${totalCC}, ${coefCC})">
                            <input type="radio" name="obj" value="14"> <strong>Bien</strong> (14/20)
                        </div>
                        <div class="objective-option" onclick="selectObjective(16, ${totalCC}, ${coefCC})">
                            <input type="radio" name="obj" value="16"> <strong>Tr√®s Bien</strong> (16/20)
                        </div>
                        <div class="objective-option" onclick="selectObjective(18, ${totalCC}, ${coefCC})">
                            <input type="radio" name="obj" value="18"> <strong>F√©licitations</strong> (18/20)
                        </div>
                    </div>

                    <div id="objectiveResult"></div>
                </div>
            `;
            document.getElementById('modeContent').innerHTML = html;
        }

        function selectObjective(target, totalCC, coefCC) {
            document.querySelectorAll('.objective-option').forEach(opt => opt.classList.remove('selected'));
            event.currentTarget.classList.add('selected');

            const pointsNecessaires = (target * 100) - totalCC;
            const coefRestants = 60;

            const notes = {
                francaisEcrit: pointsNecessaires / coefRestants,
                francaisOral: pointsNecessaires / coefRestants,
                philosophie: pointsNecessaires / coefRestants,
                specialite1: pointsNecessaires / coefRestants,
                specialite2: pointsNecessaires / coefRestants,
                grandOral: pointsNecessaires / coefRestants
            };

            let html = `
                <div class="info-box success" style="margin-top:20px;">
                    <p><strong>üìä Pour obtenir ${target}/20</strong></p>
                    <p>Avec votre CC actuel (${(totalCC/coefCC).toFixed(2)}/20), voici les notes minimales :</p>
                </div>

                <table class="notes-table">
                    <thead>
                        <tr>
                            <th>√âpreuve</th>
                            <th>Note n√©cessaire</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>üìù Fran√ßais √©crit</td><td class="note-high">${notes.francaisEcrit.toFixed(1)}/20</td></tr>
                        <tr><td>üì¢ Fran√ßais oral</td><td class="note-high">${notes.francaisOral.toFixed(1)}/20</td></tr>
                        <tr><td>üí≠ Philosophie</td><td class="note-high">${notes.philosophie.toFixed(1)}/20</td></tr>
                        <tr><td>üî¨ ${specialitesChoisies[0]?.nom || 'Sp√© 1'}</td><td class="note-high">${notes.specialite1.toFixed(1)}/20</td></tr>
                        <tr><td>üß¨ ${specialitesChoisies[1]?.nom || 'Sp√© 2'}</td><td class="note-high">${notes.specialite2.toFixed(1)}/20</td></tr>
                        <tr><td>üé§ Grand oral</td><td class="note-high">${notes.grandOral.toFixed(1)}/20</td></tr>
                    </tbody>
                </table>

                <div class="info-box">
                    <p><strong>üí° Conseil :</strong> Concentrez vos efforts sur les √©preuves √† fort coefficient (Sp√©cialit√©s = 16 chacune) !</p>
                </div>
            `;

            document.getElementById('objectiveResult').innerHTML = html;
        }

        function calculateFinalGrade(totalCC, coefCC) {
            const totalET = 
                simulatorValues.francaisEcrit * 5 +
                simulatorValues.francaisOral * 5 +
                simulatorValues.philosophie * 8 +
                simulatorValues.specialite1 * 16 +
                simulatorValues.specialite2 * 16 +
                simulatorValues.grandOral * 10;
            
            const moyenne = (totalCC + totalET) / (coefCC + 60);
            const percentage = (moyenne / 20) * 100;

            let mention, mentionClass, status;

            if (moyenne >= 18) {
                mention = 'F√©licitations';
                mentionClass = 'tb';
                status = 'üéâ Admis avec f√©licitations !';
            } else if (moyenne >= 16) {
                mention = 'Tr√®s Bien';
                mentionClass = 'tb';
                status = 'üéâ Admis TB !';
            } else if (moyenne >= 14) {
                mention = 'Bien';
                mentionClass = 'b';
                status = 'üëè Admis Bien !';
            } else if (moyenne >= 12) {
                mention = 'Assez Bien';
                mentionClass = 'ab';
                status = '‚úÖ Admis AB !';
            } else if (moyenne >= 10) {
                mention = 'Sans mention';
                status = '‚úÖ Admis';
            } else if (moyenne >= 8) {
                mention = 'Rattrapage';
                status = '‚ö†Ô∏è Rattrapage';
            } else {
                mention = 'Refus√©';
                status = '‚ùå Non admis';
            }

            return { moyenne, percentage, mention, mentionClass, status };
        }

        function updateSimulator(key, value, totalCC, coefCC) {
            simulatorValues[key] = parseFloat(value);
            document.getElementById(`val_${key}`).textContent = parseFloat(value).toFixed(1);

            const result = calculateFinalGrade(totalCC, coefCC);

            document.getElementById('moyenneDisplay').textContent = result.moyenne.toFixed(2) + '/20';
            document.getElementById('progressBar').style.width = result.percentage + '%';
            document.getElementById('progressBar').textContent = result.percentage.toFixed(1) + '%';
            document.getElementById('statusDisplay').textContent = result.status;

            const badge = document.getElementById('mentionBadge');
            if (badge) {
                badge.textContent = result.mention;
                badge.className = 'mention-badge ' + result.mentionClass;
            }
        }
    </script>
</body>
</html>
